<!DOCTYPE html>
<html>
<head>
<meta charset="ISO-8859-1">
<title>Insert title here</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/5.7.0/d3.min.js"></script>
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>

</head>
<body>
<div id="chartContainer" style="height: 370px; width: 100%;"></div>
</body>


<! Javascript Code for Pie -->
<script type="text/javascript">
window.onload = function () {

	//retrieve data from csv using d3 then send data to "makeChart" function
	d3.csv('superbowl-ads.csv')
	  .then(makeChart);
	  
	var arrayColumns = [];
	var newArrayColumns = [];
	
	function makeChart(players) {
		arrayColumns = players.columns;
		console.log("Columns", arrayColumns);
		console.log("Columns-name", arrayColumns[3]);
		
		var chart = new CanvasJS.Chart("chartContainer", {
			exportEnabled: true,
			animationEnabled: true,
			title:{
				text: "Best SuperBowl Ads Characteristics Pie Chart!"
			},
			legend:{
				cursor: "pointer",
				itemclick: explodePie
			},
			data: [{
				type: "pie",
				showInLegend: true,
				toolTipContent: "{name}: <strong>{y}%</strong>",
				indexLabel: "{name} - {y}%",
				dataPoints: [
				
				]
			}]

		});	
		chart.render();
		for(var i = 0; i < arrayColumns.length; i++){
			if( (arrayColumns[i] != "youtube_url") && (arrayColumns[i] != "year") && (arrayColumns[i] != "superbowl_ads_dot_com_url") && (arrayColumns[i] != "brand")){
				chart.data[0].dataPoints.push({ y: 2, name: "" + arrayColumns[i]});

			}

		}
		chart.render();

		}

		function explodePie (e) {
			if(typeof (e.dataSeries.dataPoints[e.dataPointIndex].exploded) === "undefined" || !e.dataSeries.dataPoints[e.dataPointIndex].exploded) {
				e.dataSeries.dataPoints[e.dataPointIndex].exploded = true;
			} else {
				e.dataSeries.dataPoints[e.dataPointIndex].exploded = false;
			}
			e.chart.render();

		}

	} 
	





  
</script>
</html>
